{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/DELL/Uswift/dashboard/lib/supabaseClient.ts"],"sourcesContent":["import { createClient } from \"@supabase/supabase-js\";\r\n\r\ndeclare const process: {\r\n  env: {\r\n    NEXT_PUBLIC_SUPABASE_URL?: string;\r\n    NEXT_PUBLIC_SUPABASE_ANON_KEY?: string;\r\n  };\r\n};\r\n\r\nconst supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL || \"\";\r\nconst supabaseAnonKey = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY || \"\";\r\n\r\nexport const supabase = createClient(supabaseUrl, supabaseAnonKey);\r\n"],"names":[],"mappings":";;;;AASoB;AATpB;;AASA,MAAM,cAAc,gFAAwC;AAC5D,MAAM,kBAAkB,wPAA6C;AAE9D,MAAM,WAAW,IAAA,0MAAY,EAAC,aAAa","debugId":null}},
    {"offset": {"line": 21, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/DELL/Uswift/dashboard/components/ui/Button.tsx"],"sourcesContent":["export default function Button({ children, ...props }: any) {\r\n  return (\r\n    <button\r\n      className=\"bg-uswift-accent text-white px-4 py-2 rounded shadow hover:brightness-90\"\r\n      {...props}\r\n    >\r\n      {children}\r\n    </button>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;;;AAAe,SAAS,OAAO,EAAE,QAAQ,EAAE,GAAG,OAAY;IACxD,qBACE,6LAAC;QACC,WAAU;QACT,GAAG,KAAK;kBAER;;;;;;AAGP;KATwB","debugId":null}},
    {"offset": {"line": 48, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/DELL/Uswift/dashboard/components/ui/Input.tsx"],"sourcesContent":["export default function Input(props: any) {\r\n  return (\r\n    <input\r\n      className=\"border border-uswift-blue rounded px-3 py-2 w-full mb-2\"\r\n      {...props}\r\n    />\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;;;AAAe,SAAS,MAAM,KAAU;IACtC,qBACE,6LAAC;QACC,WAAU;QACT,GAAG,KAAK;;;;;;AAGf;KAPwB","debugId":null}},
    {"offset": {"line": 74, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/DELL/Uswift/dashboard/app/auth/reset-password/page.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useEffect, useState } from \"react\";\r\nimport { useRouter, useSearchParams } from \"next/navigation\";\r\nimport { supabase } from \"../../../lib/supabaseClient\";\r\nimport Button from \"../../../components/ui/Button\";\r\nimport Input from \"../../../components/ui/Input\";\r\n\r\nexport default function ResetPasswordPage() {\r\n  const router = useRouter();\r\n  const searchParams = useSearchParams();\r\n  const [token, setToken] = useState<string | null>(null);\r\n  const [password, setPassword] = useState(\"\");\r\n  const [confirm, setConfirm] = useState(\"\");\r\n  const [message, setMessage] = useState(\"\");\r\n  const [loading, setLoading] = useState(false);\r\n\r\n  useEffect(() => {\r\n    const getTokenFromHash = () => {\r\n      try {\r\n        if (typeof window === \"undefined\") return null;\r\n        const hash = window.location.hash; // e.g. #access_token=...&type=recovery\r\n        if (!hash) return null;\r\n        const params = new URLSearchParams(hash.replace(/^#/, \"\"));\r\n        return params.get(\"access_token\") || params.get(\"token\");\r\n      } catch (e) {\r\n        return null;\r\n      }\r\n    };\r\n\r\n    const accessToken =\r\n      searchParams?.get(\"access_token\") ||\r\n      searchParams?.get(\"token\") ||\r\n      getTokenFromHash() ||\r\n      null;\r\n    setToken(accessToken);\r\n  }, [searchParams]);\r\n\r\n  async function handleSubmit(e: React.FormEvent) {\r\n    e.preventDefault();\r\n    setMessage(\"\");\r\n\r\n    if (!password || password.length < 8) {\r\n      setMessage(\"Password must be at least 8 characters.\");\r\n      return;\r\n    }\r\n    if (password !== confirm) {\r\n      setMessage(\"Passwords do not match.\");\r\n      return;\r\n    }\r\n\r\n    setLoading(true);\r\n\r\n    try {\r\n      if (token) {\r\n        const { error: setErr } = await supabase.auth.setSession({\r\n          access_token: token,\r\n          refresh_token: \"\",\r\n        } as any);\r\n        if (setErr) {\r\n          console.warn(\"setSession failed:\", setErr.message);\r\n          try {\r\n            const supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL || \"\";\r\n            const anonKey = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY || \"\";\r\n            if (!supabaseUrl) throw new Error(\"Missing Supabase URL\");\r\n\r\n            const res = await fetch(`${supabaseUrl.replace(/\\/$/, \"\")}/auth/v1/user`, {\r\n              method: \"PUT\",\r\n              headers: {\r\n                Authorization: `Bearer ${token}`,\r\n                apikey: anonKey,\r\n                \"Content-Type\": \"application/json\",\r\n              },\r\n              body: JSON.stringify({ password }),\r\n            });\r\n\r\n            if (!res.ok) {\r\n              const body = await res.json().catch(() => ({}));\r\n              const errMsg = body?.error_description || body?.message || `${res.status} ${res.statusText}`;\r\n              setMessage(errMsg || \"Failed to reset password\");\r\n              setLoading(false);\r\n              return;\r\n            }\r\n\r\n            setMessage(\"Password updated. Redirecting to sign in...\");\r\n            setTimeout(() => router.push(\"/auth/signin\"), 1400);\r\n            return;\r\n          } catch (restErr: any) {\r\n            console.error(\"REST password update failed:\", restErr);\r\n            setMessage(restErr?.message || \"Failed to reset password\");\r\n            setLoading(false);\r\n            return;\r\n          }\r\n        }\r\n\r\n        const { error } = await supabase.auth.updateUser({ password });\r\n        if (error) {\r\n          setMessage(error.message || \"Failed to reset password\");\r\n          setLoading(false);\r\n          return;\r\n        }\r\n\r\n        setMessage(\"Password updated. Redirecting to sign in...\");\r\n        setTimeout(() => router.push(\"/auth/signin\"), 1400);\r\n        return;\r\n      }\r\n\r\n      const { error } = await supabase.auth.updateUser({ password });\r\n      if (error) {\r\n        setMessage(error.message || \"Failed to update password\");\r\n      } else {\r\n        setMessage(\"Password updated successfully.\");\r\n        setTimeout(() => router.push(\"/auth/signin\"), 1200);\r\n      }\r\n    } catch (err: any) {\r\n      setMessage(err?.message || \"Unexpected error\");\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }\r\n\r\n  return (\r\n    <main className=\"max-w-md mx-auto mt-16 p-8 bg-white rounded shadow\">\r\n      <h1 className=\"text-2xl font-bold mb-6 text-uswift-navy\">Reset password</h1>\r\n      <p className=\"text-sm text-gray-600 mb-4\">Create a new password for your account.</p>\r\n      <form onSubmit={handleSubmit} className=\"flex flex-col gap-4\">\r\n        <Input\r\n          type=\"password\"\r\n          placeholder=\"New password\"\r\n          value={password}\r\n          onChange={(e: any) => setPassword(e.target.value)}\r\n          required\r\n        />\r\n        <Input\r\n          type=\"password\"\r\n          placeholder=\"Confirm password\"\r\n          value={confirm}\r\n          onChange={(e: any) => setConfirm(e.target.value)}\r\n          required\r\n        />\r\n        <Button type=\"submit\" disabled={loading}>\r\n          {loading ? \"Updating...\" : \"Update password\"}\r\n        </Button>\r\n      </form>\r\n      {message && <div className=\"mt-4 text-center text-uswift-accent\">{message}</div>}\r\n      {!token && (\r\n        <div className=\"mt-4 text-sm text-gray-500\">\r\n          If you reached this page without a reset link, request a password reset from the\r\n          sign-in page.\r\n        </div>\r\n      )}\r\n    </main>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}}]
}